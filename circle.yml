dependencies:
  cache_directories:
    - "~/examples/"
    - "~/downloads/"
    - "~/.local/"
  pre:
    - bash ./circle_setup.sh
  override:
    - pip install --upgrade pip
    - pip install numpy
    - pip install -r requirements.txt
    - pip install -e .
machine:
  environment:
    PATH: ${HOME}/.local/afni:${HOME}/.local/fsl/bin:${PATH}
    FSLDIR: ${HOME}/.local/fsl
    LD_LIBRARY_PATH: ${HOME}/.local/fsl/lib:${LD_LIBRARY_PATH}
    FSLOUTPUTTYPE: NIFTI_GZ
test:
  override:
    # Test mriqcp
    - python scripts/mriqcp.py -i ~/examples/ds003_sub-01/ -o /tmp/output-01 -w /tmp/workdir-01 --use-plugin ~/examples/plugin.yml
    - python scripts/mriqcp.py -i ~/examples/ds003_downsampled/ -o /tmp/output-ms -w /tmp/workdir-ms --use-plugin ~/examples/plugin.yml
general:
  artifacts:
    - "/tmp/output-01"
    - "/tmp/workdir-01"
    - "/tmp/output-ms"
    - "/tmp/workdir-ms"